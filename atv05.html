<html>
  <head>
    <title>Formul√°rio</title>
    <link rel="stylesheet" href="atv05.css">
  </head>
  <body>
    <div class='div-pai'>
      <h1>Escola Virtual</h1>
      <h2>Formul√°rio Pr√©-Matr√≠cula</h2>
      <form id="formulario-matricula">
        <fieldset class='caixatxt'>
          <div id='info-pessoais'>
            <legend>Dados Pessoais: </legend>
            <br><label>Nome do Aluno: </label> <input type='text' id="nome-aluno" name="nomeAluno">
            <span id="erro-nomeAluno" class="erro-mensagem"></span>
            
            <br><label>Nascimento (dd/mm/aaaa): </label>
            <input type='text' id='data-nascimento' name="dataNascimento" placeholder="dd/mm/aaaa">
            <span id="erro-dataNascimento" class="erro-mensagem"></span>
            
            <br><label>Nome da M√£e: </label> <input type='text' id="nome-mae" name="nomeMae">
            <span id="erro-nomeMae" class="erro-mensagem"></span>
            
            <br><label>Nome do Pai: </label> <input type='text' id="nome-pai" name="nomePai">
            <span id="erro-nomePai" class="erro-mensagem"></span>
            
            <br><label>Telefone: DDD </label> <input type='text' id="telefone-ddd" name="telefoneDDD" maxlength="2">
            <span id="erro-telefoneDDD" class="erro-mensagem"></span>
            <br><label>Telefone: N√∫mero </label> <input type='text' id="telefone-numero" name="telefoneNumero">
            <span id="erro-telefoneNumero" class="erro-mensagem"></span>
            
            <br><label>E-Mail: </label> <input type='email' id='email' name="email">
            <span id="erro-email" class="erro-mensagem"></span>
          </fieldset>
        </div>
        
        <fieldset class='caixatxt'>
          <legend>Informa√ß√µes de Matr√≠cula: </legend>
          <div id='serie' class='info-matricula'>
            <br><label>S√©rie: </label>
            <select id="serie-select" name="serie">
              <option value="" disabled selected>Selecione uma S√©rie</option> <option value="pre-escolar">Pr√©-escolar</option>
              <option value="1-fundamental">1¬∞ Fundamental</option>
              <option value="2-fundamental">2¬∞ Fundamental</option>
              <option value="ensino-medio">Ensino M√©dio</option>
            </select>
            <span id="erro-serie" class="erro-mensagem"></span>
          </div>
          
          <div id='turno' class='info-matricula'>
            <br><label>Turno: </label>
            <br><input type='radio' name="turno" value="matutino"><label>Matutino</label>
            <br><input type='radio' name="turno" value="vespertino"><label>Vespertino</label>
            <span id="erro-turno" class="erro-mensagem"></span>
          </div>
          
          <div id='atividades' class='info-matricula'>
            <br><label>Atividades Extracurriculares: (M√°x 3) </label>
            <span id="erro-atividades" class="erro-mensagem"></span>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="informatica"><label>Inform√°tica</label>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="musica"><label>M√∫sica</label>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="ballet"><label>Balet</label>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="pintura"><label>Pintura</label>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="judo"><label>Judo</label>
            <br><input type='checkbox' class="atividade-checkbox" name="atividade" value="futebol"><label>Futebol</label>
          </div>
          
          <br><input type='button' id="btn-enviar" value='Envia Formul√°rio'>
          <input type='button' id="btn-limpar" value='Limpar Formul√°rio'>
          
        </fieldset>
      </form>
      <p id="mensagem-geral" style="margin-top: 20px; font-weight: bold;"></p>
    </div>
    
    <style>
        .erro-mensagem {
            color: red;
            display: block; /* Garante que a mensagem de erro fique em uma linha separada */
            font-size: 0.9em;
            font-style: italic;
        }
    </style>
    
    <script>
      const form = document.getElementById('formulario-matricula');
      const btnEnviar = document.getElementById('btn-enviar');
      const btnLimpar = document.getElementById('btn-limpar');
      const mensagemGeral = document.getElementById('mensagem-geral');

      // Lista de inputs obrigat√≥rios (por ID)
      const camposObrigatorios = [
        'nome-aluno', 'data-nascimento', 'nome-mae', 'nome-pai',
        'telefone-ddd', 'telefone-numero', 'email', 'serie-select'
      ];

      // Array de DDDs v√°lidos no Brasil (n√£o exaustivo, mas abrangente)
      // Fonte: Pesquisa na internet
      const dddsValidos = [
        11, 12, 13, 14, 15, 16, 17, 18, 19, // SP
        21, 22, 24, // RJ
        27, 28, // ES
        31, 32, 33, 34, 35, 37, 38, // MG
        41, 42, 43, 44, 45, 46, // PR
        47, 48, 49, // SC
        51, 53, 54, 55, // RS
        61, // DF e GO
        62, 64, // GO
        63, // TO
        65, 66, // MT
        67, // MS
        68, // AC
        69, // RO
        71, 73, 74, 75, 77, // BA
        79, // SE
        81, 87, // PE
        82, // AL
        83, // PB
        84, // RN
        85, 88, // CE
        86, 89, // PI
        91, 93, 94, // PA
        92, 97, // AM
        95, // RR
        96, // AP
        98, 99 // MA
      ];
      
      // Fun√ß√£o para exibir erro localmente
      function exibirErro(campoId, mensagem) {
          const elementoErro = document.getElementById(`erro-${campoId}`);
          if (elementoErro) {
              elementoErro.textContent = mensagem;
              elementoErro.style.display = 'block';
              document.getElementById(campoId).classList.add('input-erro'); // Opcional: Adiciona classe para borda vermelha
          }
      }

      // Fun√ß√£o para limpar erro localmente
      function limparErro(campoId) {
          const elementoErro = document.getElementById(`erro-${campoId}`);
          if (elementoErro) {
              elementoErro.textContent = '';
              elementoErro.style.display = 'none';
              document.getElementById(campoId).classList.remove('input-erro'); // Opcional: Remove classe
          }
      }

      // Fun√ß√£o principal de valida√ß√£o (executada ao clicar em Enviar)
      function validarFormulario() {
          let erros = 0;
          mensagemGeral.textContent = ''; // Limpa mensagem geral

          // --- 1. Valida√ß√£o de Campos Obrigat√≥rios ---
          camposObrigatorios.forEach(id => {
              const input = document.getElementById(id);
              if (input && input.value.trim() === '') {
                  exibirErro(id, '* Campo obrigat√≥rio.');
                  erros++;
              } else {
                  limparErro(id);
              }
          });
          
          // --- 2. Valida√ß√£o Espec√≠fica: S√©rie (Select) ---
          const serieSelect = document.getElementById('serie-select');
          if (serieSelect && serieSelect.value === '') {
             exibirErro('serie', '* Selecione uma s√©rie.');
             erros++;
          } else {
             limparErro('serie');
          }

          // --- 3. Valida√ß√£o Espec√≠fica: E-mail ---
          const email = document.getElementById('email').value.trim();
          const regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
          if (email !== '' && !regexEmail.test(email)) {
              exibirErro('email', '* E-mail inv√°lido (precisa de @ e .)');
              erros++;
          }
          // (A obrigatoriedade j√° foi verificada no passo 1)

          // --- 4. Valida√ß√£o Espec√≠fica: Data de Nascimento ---
          const dataNasc = document.getElementById('data-nascimento').value.trim();
          const regexData = /^(\d{2})\/(\d{2})\/(\d{4})$/; // Formato dd/mm/aaaa
          if (dataNasc !== '') {
              const match = dataNasc.match(regexData);
              let dataValida = false;

              if (match) {
                  const dia = parseInt(match[1], 10);
                  const mes = parseInt(match[2], 10);
                  const ano = parseInt(match[3], 10);

                  const data = new Date(ano, mes - 1, dia); // M√™s √© 0-indexado (0=Jan, 11=Dez)
                  
                  // Verifica se a data √© v√°lida e se corresponde √† entrada (ex: 30/02 n√£o √© v√°lido)
                  if (data.getFullYear() === ano && (data.getMonth() + 1) === mes && data.getDate() === dia) {
                      dataValida = true;
                  }
              }

              if (!dataValida) {
                  exibirErro('dataNascimento', '* Data inv√°lida ou formato incorreto (dd/mm/aaaa).');
                  erros++;
              } else {
                  limparErro('dataNascimento');
              }
          }
          // (A obrigatoriedade j√° foi verificada no passo 1)

          // --- 5. Valida√ß√£o Espec√≠fica: DDD ---
          const ddd = document.getElementById('telefone-ddd').value.trim();
          const dddNum = parseInt(ddd, 10);
          if (ddd !== '' && !dddsValidos.includes(dddNum)) {
              exibirErro('telefoneDDD', '* DDD inv√°lido.');
              erros++;
          }
          // (A obrigatoriedade j√° foi verificada no passo 1)
          
          // --- 6. Valida√ß√£o Espec√≠fica: Turno (Radio) ---
          let turnoSelecionado = false;
          const radioTurno = document.querySelectorAll('input[name="turno"]');
          radioTurno.forEach(radio => {
              if (radio.checked) {
                  turnoSelecionado = true;
              }
          });
          
          if (!turnoSelecionado) {
              exibirErro('turno', '* Selecione um turno.');
              erros++;
          } else {
              limparErro('turno');
          }

          // --- 7. Valida√ß√£o Espec√≠fica: Limite de Atividades Extracurriculares (Opcional) ---
          const atividades = document.querySelectorAll('.atividade-checkbox:checked');
          if (atividades.length > 3) {
              exibirErro('atividades', '* M√°ximo de 3 atividades permitidas.');
              erros++;
          } else {
              limparErro('atividades');
          }
          
          // --- 8. Resultado Final ---
          if (erros === 0) {
              mensagemGeral.textContent = 'üéâ Cadastro realizado com sucesso!';
              mensagemGeral.style.color = 'green';
              form.reset();
          } else {
              mensagemGeral.textContent = `‚ùå Erro(s) no formul√°rio. Por favor, corrija os ${erros} campos indicados.`;
              mensagemGeral.style.color = 'red';
          }
      }

      // --- Adicionando Listeners de Evento ---
      btnEnviar.addEventListener('click', validarFormulario);

      btnLimpar.addEventListener('click', function() {
          form.reset();
          // Limpa todas as mensagens de erro
          document.querySelectorAll('.erro-mensagem').forEach(span => {
              span.textContent = '';
              span.style.display = 'none';
          });
          document.querySelectorAll('.input-erro').forEach(input => input.classList.remove('input-erro'));
          mensagemGeral.textContent = '';
      });
    </script>
  </body>
</html>
